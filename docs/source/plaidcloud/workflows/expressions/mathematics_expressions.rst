.. sectionauthor:: Genova Morel <genova.morel@tartansolutions.com>
.. sectionauthor:: Paul Morel <paul.morel@tartansolutions.com>

Mathematics Expressions
------------------------

.. toctree::
   :maxdepth: 2
   :includehidden:

.. sidebar:: This Page

   .. contents::
      :local: 

Expressions use a Python-like syntax and provide a lot of powerful transformation capabilities.

.. Important:: Always use table.field references in expressions

Common Mathematics Expressions
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

+----------------------+------------+-------------------------------------------------+--------------+----------+
| Analyze Expression   | Operator   | Description                                     | Example      | Result   |
+======================+============+=================================================+==============+==========+
| +                    | +          | addition                                        | 2 + 3        | 5        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| -                    | -          | subtraction                                     | 2 - 3        | -1       |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| \*                   | \*         | multiplication                                  | 2 \* 3       | 6        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| /                    | /          | division (integer division truncates results)   | 4 / 2        | 2        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('%')       | %          | modulo (remainder)                              | 5 % 4        | 1        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('^')       | ^          | exponentiation                                  | 2.0 ^ 3.0    | 8        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('\|/')     | \|/        | square root                                     | \|/ 25.0     | 5        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('\|\|/')   | \|\|/      | cube root                                       | \|\|/ 27.0   | 3        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('!')       | !          | factorial                                       | 5 !          | 120      |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('!!')      | !!         | factorial (prefix operator)                     | !! 5         | 120      |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('@')       | @          | absolute value                                  | @ -5.0       | 5        |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('&')       | &          | bitwise AND                                     | 91 & 15      | 11       |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('\|')      | \|         | bitwise OR                                      | 32 \| 3      | 35       |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('#')       | #          | bitwise XOR                                     | 17 # 5       | 20       |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('~')       | ~          | bitwise NOT                                     | ~1           | -2       |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('<<')      | <<         | bitwise shift left                              | 1 << 4       | 16       |
+----------------------+------------+-------------------------------------------------+--------------+----------+
| column.op('>>')      | >>         | bitwise shift right                             | 8 >> 2       | 2        |
+----------------------+------------+-------------------------------------------------+--------------+----------+

Mathematics Functions
^^^^^^^^^^^^^^^^^^^^^

+---------------------+--------------+--------------+-----------+----------+-----------+
| Analyze Expression  | Return Type  | Description  | Example   | Result   |           |
+=====================+==============+==============+===========+==========+===========+
| func.abs(x)         | (same as     | absolute     | abs(-17.4 | 17.4     |           |
|                     | input)       | value        | )         |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.cbrt(dp)       | Big Float    | cube root    | cbrt(27.0 | 3        |           |
|                     |              |              | )         |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.ceil(dp or     | (same as     | smallest     | ceil(-42. | -42      |           |
| numeric)            | input)       | integer not  | 8)        |          |           |
|                     |              | less than    |           |          |           |
|                     |              | argument     |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.ceiling(dp or  | (same as     | smallest     | ceiling(- | -95      |           |
| numeric)            | input)       | integer not  | 95.3)     |          |           |
|                     |              | less than    |           |          |           |
|                     |              | argument     |           |          |           |
|                     |              | (alias for   |           |          |           |
|                     |              | ceil)        |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.degrees(dp)    | Big Float    | radians to   | degrees(0 | 28.64788 |           |
|                     |              | degrees      | .5)       | 97565412 |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.exp(dp or      | (same as     | exponential  | exp(1.0)  | 2.718281 |           |
| numeric)            | input)       |              |           | 82845905 |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.floor(dp or    | (same as     | largest      | floor(-42 | -43      |           |
| numeric)            | input)       | integer not  | .8)       |          |           |
|                     |              | greater than |           |          |           |
|                     |              | argument     |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.ln(dp or       | (same as     | natural      | ln(2.0)   | 0.693147 |           |
| numeric)            | input)       | logarithm    |           | 18055994 |           |
|                     |              |              |           | 5        |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.log(dp or      | (same as     | base 10      | log(100.0 | 2        |           |
| numeric)            | input)       | logarithm    | )         |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.log(b numeric, | numeric      | logarithm to | log(2.0,  | 6        |           |
| x numeric)          |              | base b       | 64.0)     |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.mod(y, x)      | (same as     | remainder of | mod(9,4)  | 1        |           |
|                     | argument     | y/x          |           |          |           |
|                     | types)       |              |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.pi()           | Big Float    | "π" constant | pi()      | 3.141592 |           |
|                     |              |              |           | 65358979 |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.power(a dp, b  | Big Float    | a raised to  | power(9.0 | 729      |           |
| dp)                 |              | the power of | ,         |          |           |
|                     |              | b            | 3.0)      |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.power(a        | numeric      | a raised to  | power(9.0 | 729      |           |
| numeric, b numeric) |              | the power of | ,         |          |           |
|                     |              | b            | 3.0)      |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.radians(dp)    | Big Float    | degrees to   | radians(4 | 0.785398 |           |
|                     |              | radians      | 5.0)      | 16339744 |           |
|                     |              |              |           | 8        |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.random()       | Big Float    | random value | random()  |          |           |
|                     |              | in the range |           |          |           |
|                     |              | 0.0 <= x <   |           |          |           |
|                     |              | 1.0          |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.round(dp or    | (same as     | round to     | round(42. | 42       |           |
| numeric)            | input)       | nearest      | 4)        |          |           |
|                     |              | integer      |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.round(v        | numeric      | round to s   | round(42. | 42.44    |           |
| numeric, s int)     |              | decimal      | 4382,     |          |           |
|                     |              | places       | 2)        |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.setseed(dp)    | integer      | set seed for | setseed(0 | 11773149 |           |
|                     |              | subsequent   | .54823)   | 59       |           |
|                     |              | random()     |           |          |           |
|                     |              | calls (value |           |          |           |
|                     |              | between 0    |           |          |           |
|                     |              | and 1.0)     |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.sign(dp or     | (same as     | sign of the  | sign(-8.4 | -1       |           |
| numeric)            | input)       | argument     | )         |          |           |
|                     |              | (-1, 0, +1)  |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.sqrt(dp or     | (same as     | square root  | sqrt(2.0) | 1.414213 |           |
| numeric)            | input)       |              |           | 5623731  |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.trunc(dp or    | (same as     | truncate     | trunc(42. | 42       |           |
| numeric)            | input)       | toward zero  | 8)        |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.trunc(v        | numeric      | truncate to  | trunc(42. | 42.43    |           |
| numeric, s int)     |              | s decimal    | 4382,     |          |           |
|                     |              | places       | 2)        |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.width\_bucket( | integer      | return the   | width\_bu | 3        |           |
| op                  |              | bucket to    | cket(5.35 |          |           |
| numeric, b1         |              | which        | ,         |          |           |
| numeric, b2         |              | operand      | 0.024,    |          |           |
| numeric, count int) |              | would be     | 10.06, 5) |          |           |
|                     |              | assigned in  |           |          |           |
|                     |              | an equidepth |           |          |           |
|                     |              | histogram    |           |          |           |
|                     |              | with count   |           |          |           |
|                     |              | buckets, in  |           |          |           |
|                     |              | the range b1 |           |          |           |
|                     |              | to b2        |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.least(value…)  | (same as     | Select the   |           |          |           |
|                     | input)       | smallest     |           |          |           |
|                     |              | value from a |           |          |           |
|                     |              | list. NULL   |           |          |           |
|                     |              | values in    |           |          |           |
|                     |              | the list are |           |          |           |
|                     |              | ignored. The |           |          |           |
|                     |              | result will  |           |          |           |
|                     |              | be NULL only |           |          |           |
|                     |              | if all       |           |          |           |
|                     |              | values are   |           |          |           |
|                     |              | NULL.        |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+
| func.greatest(value | (same as     | Select the   |           |          |           |
| …)                  | input)       | largest      |           |          |           |
|                     |              | value from a |           |          |           |
|                     |              | list. NULL   |           |          |           |
|                     |              | values in    |           |          |           |
|                     |              | the list are |           |          |           |
|                     |              | ignored. The |           |          |           |
|                     |              | result will  |           |          |           |
|                     |              | be NULL only |           |          |           |
|                     |              | if all       |           |          |           |
|                     |              | values are   |           |          |           |
|                     |              | NULL.        |           |          |           |
+---------------------+--------------+--------------+-----------+----------+-----------+

Trigonometric Functions
^^^^^^^^^^^^^^^^^^^^^^^^^

+----------------------+--------------------------+
| Analyze Expression   | Description              |
+======================+==========================+
| func.acos(x)         | inverse cosine           |
+----------------------+--------------------------+
| func.asin(x)         | inverse sine             |
+----------------------+--------------------------+
| func.atan(x)         | inverse tangent          |
+----------------------+--------------------------+
| func.atan2(x,y)      | inverse tangent of x/y   |
+----------------------+--------------------------+
| func.cos(x)          | cosine                   |
+----------------------+--------------------------+
| func.cot(x)          | cotangent                |
+----------------------+--------------------------+
| func.sin(x)          | sine                     |
+----------------------+--------------------------+
| func.tan(x)          | tangent                  |
+----------------------+--------------------------+
